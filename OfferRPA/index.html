<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>æ‹›è˜è‡ªåŠ¨åŒ–ç³»ç»Ÿç®¡ç†é¢æ¿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* åŸºç¡€æ ·å¼ */
     body {
  margin: 0;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background: #f5f7fa;
  color: #333;
  display: flex;
  min-height: 100vh; /* ä¿è¯è‡³å°‘æ’‘æ»¡å±å¹• */
  align-items: stretch; /* è®©å­å…ƒç´ éƒ½æ’‘æ»¡é«˜åº¦ */
}

nav {
  width: 220px;
  background: #004a9f;
  color: white;
  display: flex;
  flex-direction: column;
  padding-top: 20px;
  /* å»æ‰é«˜åº¦é™åˆ¶ */
  /* height: 100vh; */
  min-height: 100vh; /* ä¿è¯å¯¼èˆªæ è‡³å°‘æ’‘æ»¡è§†å£é«˜åº¦ */
  box-sizing: border-box;
  overflow-y: auto;  /* å…è®¸å†…å®¹æ»šåŠ¨ï¼Œé¿å…å†…å®¹æº¢å‡ºè¢«è£å‰ª */
}

    nav h2 {
      margin: 0 0 20px 20px;
      font-weight: 700;
      font-size: 1.4rem;
    }

    /* å†…å®¹åŒºåŸŸ */
    main {
      flex-grow: 1;
      padding: 30px;
      overflow-y: auto;
    }
    main h1 {
      margin-top: 0;
      color: #004a9f;
    }
    section.module {
      display: none;
    }
    section.module.active {
      display: block;
    }
    /* å…¬å…±è¡¨å•æ ·å¼ */
    label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
    }
    input, select, textarea, button {
      margin-top: 6px;
      padding: 8px 12px;
      width: 100%;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }


    /* æ—¥å¿—åŒºåŸŸ */

    #log {
  margin-top: 40px;
  background: #eaeef6;
  border-radius: 6px;
  padding: 10px 15px 5px 15px; /* ä¸Šä¸‹å†…è¾¹è·è°ƒæ•´ï¼Œä¸Šé¢ç¨å°ï¼Œä¸‹é¢æ›´å° */
  max-height: 180px;
  overflow-y: hidden;  /* å…³é—­æ»šåŠ¨æ¡ */
  font-size: 0.9rem;
  color: #555;
  white-space: pre-wrap;
  line-height: 1.4;     /* å¯ä»¥è°ƒæ•´è¡Œé«˜ï¼Œæ–‡å­—æ›´ç´§å‡‘ */
}


#candidate-profile label {
  display: block;
  margin-top: 8px;
  font-weight: 600;
  color: #333;
}

#candidate-profile input[type="email"],
#candidate-profile input[type="text"],
#candidate-profile textarea {
  width: 100%;
  padding: 8px 10px;
  margin-top: 4px;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
  font-size: 14px;
}

/* æŒ‰é’®ç»Ÿä¸€åŸºç¡€æ ·å¼ */
button {
  display: inline-block;
  padding: 10px 16px;
  font-size: 1rem;
  font-weight: 600;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
  background-color: #0078d4;
  color: white;
  width: auto;       /* å–æ¶ˆå®½åº¦100%ï¼Œé¿å…æŒ‰é’®è¿‡å®½ */
  box-sizing: border-box;
  text-align: center;
}

/* é»˜è®¤æŒ‰é’® hover æ•ˆæœ */
button:hover {
  background-color: #005ea2;
}

/* ä¾§è¾¹å¯¼èˆªæŒ‰é’®ç‰¹æœ‰ */
nav button {
  width: 100%;      /* å¯¼èˆªæ æŒ‰é’®æ’‘æ»¡å®½åº¦ */
  text-align: left;
  background-color: transparent;
  color: white;
  padding: 15px 20px;
  font-weight: 400;
  border-left: 4px solid transparent;
  transition: background 0.3s ease, border-color 0.3s ease, font-weight 0.3s ease;
}

/* ä¾§è¾¹å¯¼èˆªæŒ‰é’® hover å’Œ active çŠ¶æ€ */
nav button:hover, nav button.active {
  background-color: #0063d1;
  border-left-color: #ffcc00;
  font-weight: 700;
}

/* ä¸»ä½“åŒºåŸŸå¸¦ .primary ç±»çš„æŒ‰é’® */
button.primary {
  background-color: #0078d4;
  color: white;
  border: none;
  width: auto;
  margin-top: 20px;
}

button.primary:hover {
  background-color: #005ea2;
}

/* #candidate-profile æ¨¡å—ç‰¹å®šæŒ‰é’® */
#candidate-profile button {
  padding: 8px 16px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  margin-top: 12px;
  color: white;
  background-color: #0078d4;
  width: auto;
}

#candidate-profile button.primary {
  background-color: #0078d4;
}

#candidate-profile button.secondary {
  background-color: #f5f1e9;
  color: #7a6f4f;
  margin-left: 8px;
  border: 1px solid #d9d2bf;
  transition: background-color 0.3s ease, border-color 0.3s ease;
}

#candidate-profile button.secondary:hover {
  background-color: #f0eadc;
  border-color: #dcd5b8;
}

#candidate-profile button#callZapier {
  background-color: #e6f0ff;
  color: #1a2a5a;
  margin-left: 8px;
  border: 1px solid #a3b8ff;
  transition: background-color 0.3s ease, border-color 0.3s ease;
}

#candidate-profile button#callZapier:hover {
  background-color: #d7e4ff;
  border-color: #a3b8ff;
}




.chat-container {
  display: flex;
  flex-direction: column;
  height: 100vh; /* æˆ–è€…ä½ éœ€è¦çš„å›ºå®šé«˜åº¦ */
  background-color: #F7F8FC;
  overflow: hidden; /* é˜²æ­¢å¤–éƒ¨æ»šåŠ¨ */
}

/* èŠå¤©å¤´éƒ¨ */
.chat-header {
  flex-shrink: 0;
  height: auto;       /* è®©é«˜åº¦è‡ªé€‚åº” */
  padding: 12px 20px; /* é€‚å½“å¢åŠ å·¦å³å†…è¾¹è· */
  background-color: #6A4FB6;
  color: white;
  font-weight: 600;
  user-select: none;
  box-shadow: 0 2px 6px rgba(106, 79, 182, 0.4);
  position: relative;
  line-height: 1.4;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 4px;  /* ä¸Šä¸‹è¡Œé—´è· */
  font-size: 15px;
}


/* æ¶ˆæ¯åŒºè‡ªåŠ¨æ’‘æ»¡å‰©ä½™é«˜åº¦ï¼Œä¸”æ”¯æŒæ»šåŠ¨ */
.chat-messages {
  flex: 1 1 auto;
  overflow-y: auto;
  background: white;
  padding: 16px;
  border-top: 1px solid #E5E3F4;
  border-bottom: 1px solid #E5E3F4;
  box-sizing: border-box;
  word-break: break-word;
}

/* è¾“å…¥åŒºå›ºå®šé«˜åº¦ï¼Œä¸å…è®¸ä¼¸ç¼© */
.chat-input {
  flex-shrink: 0;
  display: flex;
  padding: 12px 16px;
  background-color: #F7F8FC;
  border-top: 1px solid #E5E3F4;
  align-items: center;
  gap: 12px;
  height: 60px;
  box-sizing: border-box;
}

.chat-input input {
  flex-grow: 1;
  padding: 10px 14px;
  font-size: 16px;
  border: 1px solid #C3B7F0;
  border-radius: 20px;
  background-color: white;
  outline: none;
  transition: border-color 0.3s;
}

.chat-input input:focus {
  border-color: #8B6ECF;
}

.chat-input button {
  padding: 10px 20px;
  font-size: 16px;
  background-color: #6A4FB6;
  color: white;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(106, 79, 182, 0.4);
  flex-shrink: 0;
  transition: background-color 0.3s, box-shadow 0.3s;
}

.chat-input button:hover {
  background-color: #593aa5;
  box-shadow: 0 3px 8px rgba(89, 58, 165, 0.6);
}

.loading {
  margin-top: 24px;
  font-style: italic;
  color: var(--text-subtle);
  font-size: 15px;
  animation: fadeIn 0.5s ease;
}

table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin-top: 36px;
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.03);
  animation: fadeInUp 0.5s ease;
}

th, td {
  padding: 18px 22px;
  text-align: left;
  border-bottom: 1px solid #f1f5f9;
  font-size: 15px;
}

th {
  background-color: #f9fafb;
  font-weight: 600;
  color: #334155;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-size: 13px;
}

td {
  color: #1f2937;
}

tr:hover {
  background-color: var(--hover);
  transition: background 0.2s ease;
}

tr:last-child td {
  border-bottom: none;
}

a {
  color: var(--primary);
  text-decoration: none;
  font-weight: 500;
}

a:hover {
  text-decoration: underline;
}

/* åŠ¨ç”»æ•ˆæœ */
@keyframes fadeIn {
  from { opacity: 0 }
  to { opacity: 1 }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
  
}


  </style>
</head>
<body> 


<nav> 
  <h2>æ‹›è˜è‡ªåŠ¨åŒ–ç³»ç»Ÿ</h2>

  <button data-target="candidate-profile">é‚®ç®±éªŒè¯</button>
  <button data-target="job-management">èµ„æ–™å½•å…¥</button> 
  <button data-target="interview-schedule">é¢è¯•é€šçŸ¥</button>
  <button data-target="ai-screening">äº¤æµç©ºé—´</button>
  <button data-target="candidate-database">å€™é€‰èµ„æ–™åº“</button>
</nav>

<main>

<!-- æ¨¡å— â‘  é‚®ç®±éªŒè¯ -->
<section id="candidate-profile" class="module active">
  <h1>ğŸ“§ é‚®ç®±éªŒè¯</h1>
  <form id="partnerForm">
    <label for="partnerEmail">å€™é€‰äººé‚®ç®±ï¼ˆå¿…å¡«ï¼‰</label>
   <input type="email" id="partnerEmail" name="email" placeholder="è¯·è¾“å…¥é‚®ç®±" />
    <button type="submit" id="sendVerification">éªŒè¯é‚®ç®±</button>
    <div id="formMessage" style="margin-top:12px; font-weight:500;"></div>
  </form>
</section>


  <!-- æ¨¡å— â‘¡ èµ„æ–™å½•å…¥ -->
  <section id="job-management" class="module">
    <h1>ğŸ“ èµ„æ–™å½•å…¥</h1>
    <label for="email">å€™é€‰äººé‚®ç®±</label>
    <input type="email" id="email" placeholder="abc@example.com" required />
    <label for="jobTitle">å²—ä½åç§°</label>
    <input type="text" id="jobTitle" placeholder="åç«¯å¼€å‘å·¥ç¨‹å¸ˆ" />
    <label for="resume">ç®€å†æˆ–å¤‡æ³¨</label>
    <textarea id="resume" rows="5" placeholder="ç®€å†å†…å®¹..."></textarea>
    <button onclick="submitToZapier()">æäº¤åˆ°Database</button>
    <div id="status"></div>
  </section>

  <!-- æ¨¡å— â‘¢ é¢è¯•é€šçŸ¥ -->
  <section id="interview-schedule" class="module">
    <h1>ğŸ“… é¢è¯•å®‰æ’é€šçŸ¥</h1>
    <label for="interviewCandidate">å€™é€‰äººé‚®ç®±</label>
    <input type="email" id="interviewCandidate" placeholder="è¾“å…¥å€™é€‰äººé‚®ç®±" />
    <label for="interviewTime">é¢è¯•æ—¶é—´</label>
    <input type="datetime-local" id="interviewTime" />
    <button class="primary" id="scheduleInterview">å‘é€é¢è¯•é€šçŸ¥</button>
    <div id="interviewStatus" style="margin-top:12px;"></div>
  </section>



  <!-- æ¨¡å— â‘£ äº¤æµç©ºé—´ -->
  <section id="ai-screening" class="module">
    <h1>ğŸ—ƒï¸ äººæ‰äº¤æµç©ºé—´</h1>
    <p>å¿«é€Ÿè¿æ¥æ½œåœ¨å€™é€‰äººï¼Œç§’åˆ›äº¤æµç©ºé—´ï¼Œè½»æ¾è”ç»“äººæ‰ï¼Œæå‡æ‹›è˜æ•ˆç‡ã€‚ğŸ“ˆ 

</p>

    <!-- æˆ¿é—´è¾“å…¥ç•Œé¢ -->
    <div id="roomEntry" style="margin-top:20px;">
      <div style="display:flex; gap: 10px; flex-wrap: wrap;">
        <input id="nameInput" placeholder="ä½ çš„åå­—" style="flex:1; min-width:150px;"/>
        <input id="roomInput" placeholder="è¾“å…¥æˆ¿é—´å·" style="flex:1; min-width:150px;"/>
        <button id="joinBtn" class="primary" style="flex-shrink:0;">åŠ å…¥æˆ¿é—´</button>
      </div>
    </div>

    <!-- èŠå¤©ç•Œé¢ -->
    <div class="chat-container" id="chatContainer" style="display: none; margin-top: 20px; height: 400px; border: 1px solid #ccc; border-radius: 6px; background: white;">
      <div class="chat-header" style="flex-shrink: 0; padding: 12px 20px; background-color: #6A4FB6; color: white; font-weight: 600; user-select: none; box-shadow: 0 2px 6px rgba(106, 79, 182, 0.4); display: flex; flex-direction: column; gap: 4px; font-size: 15px; position: relative; line-height: 1.4;">
        <div style="display: flex; align-items: center;">
          <button id="callBtn" class="call-btn" title="è¯­éŸ³é€šè¯" aria-label="è¯­éŸ³é€šè¯" style="
            width: 32px;
            height: 32px;
            background-color: #8B6ECF;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 0;
            box-shadow: 0 2px 6px rgba(139, 110, 207, 0.6);">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="#ffffff" viewBox="0 0 24 24">
              <path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.27 11.36 11.36 0 003.54.57 1 1 0 011 1V19a1 1 0 01-1 1A17 17 0 013 5a1 1 0 011-1h3.5a1 1 0 011 1 11.36 11.36 0 00.57 3.54 1 1 0 01-.27 1.11z"/>
            </svg>
          </button>
          <span style="font-size: 15px;">æˆ¿é—´ä¸­ï¼ˆæ”¯æŒè¯­éŸ³+æ–‡å­—ï¼‰</span>
        </div>
        <div style="font-weight: 400; font-size: 13px; color: #D3C9F3;">
          ğŸŸ¢ åœ¨çº¿ - <strong>abc</strong> åœ¨æˆ¿é—´ <strong>123</strong>
        </div>
        <span id="statusIndicator" style="display:none;"></span>
      </div>

      <div class="chat-messages" id="messages" style="flex: 1; overflow-y: auto; padding: 12px; font-size: 14px; color: #2B2346; background: #ECE8FF; border-top: 1px solid #ccc; border-bottom: 1px solid #ccc;">
        <!-- èŠå¤©å†…å®¹ -->
      </div>
    </div>

    <div class="chat-input" style="padding:10px;">
      <input id="msgInput" placeholder="è¾“å…¥æ¶ˆæ¯..." style="flex:1; padding:8px 12px; border-radius:6px; border:1px solid #C3B7F0; font-size:14px;" />
      <button id="sendBtn" class="primary" style="margin-left:10px; flex-shrink:0;">å‘é€</button>
    </div>


<!-- åˆ†äº«æˆ¿é—´é“¾æ¥åŒºåŸŸ -->
<div id="shareLinkContainer" style="margin-top: 20px; display: flex; align-items: center; gap: 10px; font-size: 13px; color: #888;">
  <label for="roomLinkInput" style="flex-shrink: 0;">åˆ†äº«æˆ¿é—´é“¾æ¥ï¼š</label>
  <input id="roomLinkInput" type="password" readonly
         style="flex:1; padding: 6px; border-radius: 4px; border: 1px solid #eee; background: #f8f8f8; color: #aaa; font-size: 13px; user-select: all;" />
  <button id="copyLinkBtn" style="background: none; border: 1px solid #ddd; color: #666; padding: 5px 8px; border-radius: 4px; font-size: 13px;">
    å¤åˆ¶é“¾æ¥
  </button>
</div>


</section>


  <!-- æ¨¡å— â‘¤ å€™é€‰èµ„æ–™åº“ -->
  <section id="candidate-database" class="module">
    <h2>ğŸ“‚ å€™é€‰äººèµ„æ–™åº“</h2>
    <button onclick="loadResumes()">ç‚¹å‡»åŠ è½½å€™é€‰äººåˆ—è¡¨</button>
    <div id="loading" class="loading" style="display:none;">æ­£åœ¨åŠ è½½æ•°æ®ï¼Œè¯·ç¨å€™...</div>
    <table id="resumeTable" style="display: none;">
      <thead>
        <tr>
          <th>Email</th>
          <th>èŒä½</th>
          <th>ç®€å†æ‘˜è¦</th>
          <th style="display:none;">Notion é¡µé¢</th>

        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- æ—¥å¿—é¢æ¿ -->
  <div id="log" style="margin-top: 30px;">
    <h2>ğŸ§¾ æ“ä½œæ—¥å¿—</h2>
    <pre id="logContent">æš‚æ— æ“ä½œæ—¥å¿—</pre>
  </div> 

</main>

  <script>  

const partnerForm = document.getElementById('partnerForm');
const partnerEmail = document.getElementById('partnerEmail');
const partnerName = document.getElementById('partnerName');
const userTypeSelect = document.getElementById('userType');  // å…è®¸ä¸º null
const formMessage = document.getElementById('formMessage');

if (partnerForm) {
  let isSubmitting = false;

  partnerForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (isSubmitting) return;

    // æ¸…é™¤æç¤º
    formMessage.textContent = '';
    formMessage.classList.remove('error');

    const email = partnerEmail.value.trim();
    const name = partnerName ? partnerName.value.trim() : '';
    const userType = userTypeSelect ? userTypeSelect.value.trim() : '';  // âœ… userType å¯é€‰

    // éªŒè¯é‚®ç®±æ ¼å¼
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!email || !emailPattern.test(email)) {
      formMessage.textContent = 'âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'; 
      formMessage.style.color = 'red'; 
      formMessage.classList.add('error');
      return;
    }

    isSubmitting = true;

    try {
      const res = await fetch('https://my-netlify-hof.netlify.app/.netlify/functions/send-verification-email', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, name, userType }), // âœ… userType å¯ä¸ºç©º
        mode: 'cors',
      });

      const data = await res.json();

      if (res.ok) {
        formMessage.textContent = 'âœ… æäº¤æˆåŠŸï¼è¯·æŸ¥æ”¶éªŒè¯é‚®ä»¶ï¼Œæˆ‘ä»¬ä¼šå°½å¿«è”ç³»æ‚¨ã€‚';
        partnerForm.reset();

        setTimeout(() => {
          formMessage.textContent = '';
          formMessage.classList.remove('error');
        }, 3000);
      } else {
        formMessage.textContent = data.error || 'æäº¤å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚';
        formMessage.classList.add('error');
      }

    } catch (err) {
      formMessage.textContent = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥è¿æ¥åé‡è¯•ã€‚';
      formMessage.classList.add('error');
      console.error('[partner-form] error:', err);

    } finally {
      isSubmitting = false;
    }
  });

}


 async function submitToZapier() {
      const email = document.getElementById('email').value.trim();
      const jobTitle = document.getElementById('jobTitle').value.trim();
      const resume = document.getElementById('resume').value.trim();
      const status = document.getElementById('status');

      if (!email || !email.includes('@')) {
        status.textContent = 'âŒ è¯·å¡«å†™æœ‰æ•ˆçš„é‚®ç®±åœ°å€';
        status.style.color = 'red';
        return;
      }

      status.textContent = 'â³ æ­£åœ¨æäº¤ï¼Œè¯·ç¨å€™...';
      status.style.color = 'black';

      try {
        const res = await fetch('https://my-netlify-hof.netlify.app/.netlify/functions/partner-connect', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            email,
            jobTitle,
            resume,
            action: 'callZapier'
          })
        });

        const result = await res.json();

        if (res.ok) {
          status.textContent = 'âœ… æˆåŠŸå½•å…¥Database';
          status.style.color = 'green';
        } else {
          status.textContent = 'âŒ é”™è¯¯ï¼š' + (result.error || 'æœªçŸ¥é”™è¯¯');
          status.style.color = 'red';
        }

      } catch (err) {
        console.error('ç½‘ç»œå¼‚å¸¸:', err);
        status.textContent = 'âŒ ç½‘ç»œå¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•';
        status.style.color = 'red';
      }
    }




    async function loadResumes() {
      const loading = document.getElementById('loading');
      const table = document.getElementById('resumeTable');
      const tbody = table.querySelector('tbody');

      loading.style.display = 'block';
      table.style.display = 'none';
      tbody.innerHTML = '';


      try {
        const res = await fetch('https://my-netlify-hof.netlify.app/.netlify/functions/notion-query-all');
        const data = await res.json();

        if (!data.results || data.results.length === 0) {
          loading.innerText = 'æš‚æ— æ•°æ®';
          return;
        }

        data.results.forEach(item => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${item.email}</td>
            <td>${item.jobTitle}</td>
            <td>${item.resume}</td>
            <td style="display:none;"><a href="${item.notionUrl}" target="_blank">æŸ¥çœ‹</a></td>

          `;
          tbody.appendChild(tr);
        });

        table.style.display = 'table';
        loading.style.display = 'none';
      } catch (err) {
        loading.innerText = 'åŠ è½½å¤±è´¥ï¼š' + err.message;
      }
    }



     // âœ… æ¨¡å—åˆ‡æ¢é€»è¾‘
  document.addEventListener('DOMContentLoaded', () => {
    const buttons = document.querySelectorAll('nav button[data-target]');
    const modules = document.querySelectorAll('main section.module');
    const allMainHeaders = document.querySelectorAll('main > h1');

    function showModule(targetId) {
      // 1. æ¿€æ´»æŒ‰é’®æ ·å¼
      buttons.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.target === targetId);
      });

      // 2. æ˜¾ç¤ºå¯¹åº” section.moduleï¼Œéšè—å…¶ä»–
      modules.forEach(section => {
        section.classList.toggle('active', section.id === targetId);
      });

      // 3. éšè—æ‰€æœ‰ main ä¸‹çš„ h1ï¼ˆè¿™äº›æ˜¯æ¨¡å—æ ‡é¢˜ï¼‰
      allMainHeaders.forEach(h => h.style.display = 'none');

      // 4. æ˜¾ç¤ºå½“å‰æ¨¡å—å†…çš„æ ‡é¢˜ï¼ˆå¦‚æœæ¨¡å—æ²¡æœ‰å°è£…åœ¨ <section> é‡Œå°±ç‰¹æ®Šå¤„ç†ï¼‰
      const targetSection = document.getElementById(targetId);
      if (!targetSection) return;

      // è‹¥æ¨¡å—å¤–éƒ¨å­˜åœ¨ h1ï¼ˆå¦‚é‚®ç®±éªŒè¯/èµ„æ–™å½•å…¥ï¼‰ï¼Œä¹Ÿæ˜¾ç¤º
      const h1sInside = targetSection.querySelectorAll('h1');
      h1sInside.forEach(h => h.style.display = 'block');
    }

    // é»˜è®¤å±•ç¤ºç¬¬ä¸€ä¸ªæ¨¡å—ï¼ˆå¦‚æœæœ‰ï¼‰
    if (buttons.length > 0) {
      const firstTarget = buttons[0].dataset.target;
      showModule(firstTarget);
    }

    // ç»‘å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶
    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        const targetId = btn.dataset.target;
        showModule(targetId);
      });
    });
  });

    // é¡µé¢åˆ‡æ¢é€»è¾‘
  document.querySelectorAll("nav button").forEach(btn => {
    btn.addEventListener("click", () => {
      const targetId = btn.dataset.target;

      // åˆ‡æ¢æŒ‰é’®æ ·å¼
      document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      // åˆ‡æ¢æ¨¡å—æ˜¾ç¤º
      document.querySelectorAll("section.module").forEach(section => {
        if (section.id === targetId) {
          section.classList.add("active");
        } else {
          section.classList.remove("active");
        }
      });

      // å¯é€‰ï¼šè®°å½•æ—¥å¿—
      const log = document.getElementById("logContent");
      if (log) {
        const timestamp = new Date().toLocaleTimeString();
        log.textContent = `[${timestamp}] åˆ‡æ¢åˆ°æ¨¡å—ï¼š${btn.textContent}\n` + log.textContent;
      }
    });
  });




// è·å–DOMå…ƒç´ 
const roomEntry = document.getElementById('roomEntry');
const chatContainer = document.getElementById('chatContainer');
const joinBtn = document.getElementById('joinBtn');
const nameInput = document.getElementById('nameInput');
const roomInput = document.getElementById('roomInput');
const messages = document.getElementById('messages');
const msgInput = document.getElementById('msgInput');
const sendBtn = document.getElementById('sendBtn');
const statusIndicator = document.getElementById('statusIndicator');

const shareLinkContainer = document.getElementById('shareLinkContainer');
const roomLinkInput = document.getElementById('roomLinkInput');
const toggleLinkBtn = document.getElementById('toggleLinkBtn');
const copyLinkBtn = document.getElementById('copyLinkBtn');

joinBtn.onclick = () => {
  const name = nameInput.value.trim();
  const room = roomInput.value.trim();
  if (!name || !room) {
    alert('è¯·è¾“å…¥åå­—å’Œæˆ¿é—´å·');
    return;
  }

  // éšè—åŠ å…¥æˆ¿é—´ç•Œé¢ï¼Œæ˜¾ç¤ºèŠå¤©ç•Œé¢
  roomEntry.style.display = 'none';
  chatContainer.style.display = 'flex';

  // æ›´æ–°çŠ¶æ€æ 
  statusIndicator.textContent = `ğŸŸ¢ åœ¨çº¿ - ${name} åœ¨æˆ¿é—´ ${room}`;

  // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
  messages.innerHTML = `<div><strong>ç³»ç»Ÿï¼š</strong> æ¬¢è¿ <em>${name}</em> è¿›å…¥æˆ¿é—´ <em>${room}</em>ï¼</div>`;

  // æ„é€ åˆ†äº«é“¾æ¥
  const shareUrl = `${window.location.origin}${window.location.pathname}?room=${encodeURIComponent(room)}&name=${encodeURIComponent(name)}`;
  roomLinkInput.value = shareUrl;

  // æ˜¾ç¤ºåˆ†äº«é“¾æ¥åŒºåŸŸ
  shareLinkContainer.style.display = 'flex';

  // éšè—æ˜¾ç¤º/éšè—é“¾æ¥æŒ‰é’®
  toggleLinkBtn.style.display = 'none';

  // å¤åˆ¶æŒ‰é’®é€»è¾‘
  copyLinkBtn.onclick = () => {
    roomLinkInput.select();
    roomLinkInput.setSelectionRange(0, 99999);
    document.execCommand('copy');
    alert('æˆ¿é—´é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
  };
};

// å‘é€æ¶ˆæ¯
sendBtn.onclick = () => {
  const text = msgInput.value.trim();
  if (!text) return;
  const name = nameInput.value.trim() || 'æˆ‘';
  const msgDiv = document.createElement('div');
  msgDiv.textContent = `${name}: ${text}`;
  messages.appendChild(msgDiv);
  messages.scrollTop = messages.scrollHeight;
  msgInput.value = '';
  msgInput.focus();
};

// æ”¯æŒå›è½¦å‘é€
msgInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') sendBtn.click();
});


</script>

</body>



</html> 